<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PythonéŸ³ä¹æ’­æ”¾å™¨ï¼šAutoPlayer - CoccusQçš„åšå®¢</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body class="layout-container">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="https://coccusq.github.io" class="navbar-logo">CoccusQ</a>
            <div class="navbar-links">
                <a href="https://coccusq.github.io/about">å…³äºæœ¬ç«™âœ“</a>
                <a href="https://github.com/CoccusQ/coccusq.github.io">GitHubâ†—</a>
            </div>
        </div>
    </nav>

    <!-- å·¦ä¾§è¾¹æ  -->
    <aside class="sidebar-left">
        <!-- å·¦ä¾§å¯¼èˆªå†…å®¹ -->
    </aside>

    <main class="main-content">
        <header class="article-header">
            <h1 class="article-title" id="headline">PythonéŸ³ä¹æ’­æ”¾å™¨ï¼šAutoPlayer</h1>
            <div class="article-meta">
                By <a href="https://github.com/CoccusQ">CoccusQ</a> Â· 2025.03.10 Update
            </div>
        </header>
        <!-- ä¸‹é¢è¿™ä¸ªæ˜¯å ä½ç¬¦ï¼Œä¸èƒ½å»é™¤ -->
        <section class="section">
            <h2 class="section-title" id="å‰è¨€">å‰è¨€</h2>
            <p>æ¯æ¬¡å¬éŸ³ä¹çš„æ—¶å€™ï¼Œå‘ç°åœ¨éŸ³ä¹è½¯ä»¶é‡Œå¾ˆå¤šæƒ³å¬çš„æ­Œæ²¡æœ‰æˆ–è€…æ˜¯è¦ä»˜è´¹ï¼Œè€Œåœ¨bç«™ä¸Šæœ‰å¾ˆå¤šå¥½å¿ƒäººä¸Šä¼ çš„éŸ³ä¹è§†é¢‘ã€‚</p>
            <p>ä½†æ˜¯åœ¨bç«™ä¸Šå¬éŸ³ä¹ä¹Ÿæœ‰ä¸ªé—®é¢˜ï¼Œæƒ³è¦åˆ‡æ­Œçš„æ—¶å€™éœ€è¦æ‰‹åŠ¨åˆ‡æ¢ç½‘é¡µï¼Œå¾ˆä¸æ–¹ä¾¿ã€‚</p>
            <p>äºæ˜¯æˆ‘åˆ©ç”¨<code>python</code>çš„<code>selenium</code>åº“å®ç°äº†ä¸€ä¸ªèƒ½å¤Ÿæ ¹æ®ç»™å‡ºçš„bç«™é“¾æ¥åˆ—è¡¨è‡ªåŠ¨æ’­æ”¾éŸ³ä¹çš„ç¨‹åºï¼Œæ”¯æŒ<code>åˆ—è¡¨å¾ªç¯</code>ã€<code>å•æ›²å¾ªç¯</code>ã€<code>ä¹±åºæ’­æ”¾</code>ã€‚
            </p>
            <a href="https://github.com/CoccusQ/autoplayer">é¡¹ç›®GitHubä»“åº“é“¾æ¥ï¼šAutoPlayer</a>
        </section>
        <section class="section">
            <h2 class="section-title" id="å·¥ä½œåŸç†">å·¥ä½œåŸç†</h2>
            <p>ç¨‹åºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
            <p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯<code>è‡ªåŠ¨ç™»å½•è„šæœ¬</code>ï¼Œç”¨æ¥è§£å†³æ¯æ¬¡ç”¨æ’­æ”¾å™¨æ‰“å¼€ç½‘é¡µæ—¶éœ€è¦ç™»å½•bç«™çš„é—®é¢˜ï¼›</p>
            <p>ç¬¬äºŒéƒ¨åˆ†æ˜¯<code>éŸ³ä¹æ’­æ”¾å™¨</code>ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¤„ç†UIç•Œé¢çš„äº¤äº’é€»è¾‘ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¤„ç†éŸ³ä¹æ’­æ”¾é€»è¾‘ã€‚</p>
        </section>
        <section class="section">
            <h2 class="section-title" id="Part1è‡ªåŠ¨ç™»å½•">Part 1 è‡ªåŠ¨ç™»å½•</h2>
            <p>é€šè¿‡æœé›†èµ„æ–™å‘ç°ï¼Œbç«™çš„ç™»å½•é‡‡ç”¨å¸¸è§çš„<code>cookie</code>æœºåˆ¶ã€‚</p>
            <p>ä¹Ÿå°±æ˜¯è¯´åªè¦ç™»å½•è¿‡ä¸€æ¬¡ï¼Œæµè§ˆå™¨å°±ä¼šå°†ç™»å½•ä¿¡æ¯å­˜åœ¨<code>cookie</code>æ–‡ä»¶ä¸­ï¼›ä¸‹æ¬¡æ‰“å¼€bç«™æ—¶ï¼Œç½‘ç«™ä¼šå…ˆæ£€æµ‹<code>cookie</code>æ–‡ä»¶ä¸­çš„ç™»å½•ä¿¡æ¯ï¼Œå¦‚æœç™»å½•ä¿¡æ¯æœ‰æ•ˆï¼Œbç«™å°±ä¼šæ­£å¸¸ç™»å½•ã€‚
            </p>
            <p>äºæ˜¯ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡æ‰“å¼€æµè§ˆå™¨æ—¶å°†æµè§ˆå™¨çš„<code>cookie</code>æ–‡ä»¶æ›¿æ¢ä¸ºå‡†å¤‡å¥½çš„åŒ…å«bç«™ç™»å½•ä¿¡æ¯çš„<code>cookie</code>å³å¯ã€‚</p>
            <p>è¿™æ ·å°±è§£å†³äº†æ¯æ¬¡ä½¿ç”¨è„šæœ¬æ‰“å¼€bç«™éƒ½ä¼šä¸æ–­å¼¹å‡ºç™»å½•æç¤ºçš„é—®é¢˜ï¼ˆè¿™ä¸ªç™»å½•æç¤ºå¤ªä¸äººæ€§åŒ–äº†ï¼Œè¿™æ˜¯é€¼ç€æ¸¸å®¢ç™»å½•å•Šï¼‰</p>
            <p>äºæ˜¯æˆ‘ä»¬æœ‰ä»¥ä¸‹çš„å®ç°ä»£ç ï¼ˆè¿™æ®µä»£ç å…¶å®æ˜¯ä»¥å‰åœ¨ç½‘ä¸Šæ‰¾çš„ç™»å½•è„šæœ¬ï¼Œå…¶æ¥æºç”±äºå¹´ä»£ä¹…è¿œæš‚æ—¶æ‰¾ä¸åˆ°äº†ï¼‰</p>

            <pre class="language-python"><code># login.py
from selenium import webdriver
 
driver = webdriver.Edge()
driver.get(&#x27;https://www.bilibili.com/&#x27;)
 
&#x27;&#x27;&#x27;
æ‰“å¼€ç½‘é¡µåç›´æ¥ç™»å½•
æ‰‹åŠ¨ç™»å½•å®Œæˆååœ¨å‘½ä»¤è¡Œå†…æŒ‰å›è½¦ï¼Œå› ä¸ºæˆ‘ç”¨inputé˜»å¡äº†
ç­‰æç¤ºè¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°åŒçº§ç›®å½•ä¸‹å¤šå‡ºä¸€ä¸ªåä¸º jsoncookie.jsonçš„æ–‡ä»¶ã€‚é‡Œé¢å­˜çš„æ˜¯cookie
&#x27;&#x27;&#x27;
 
driver.implicitly_wait(10)
 
input(&quot;æ‰‹åŠ¨ç™»å½•ï¼Œå®Œæˆåè¯·åœ¨å‘½ä»¤è¡Œå†…æŒ‰å›è½¦ç»§ç»­&quot;)
driver.get(&quot;https://www.bilibili.com/&quot;)
dictcookie = driver.get_cookies()
print(&#x27;dictcookie:&#x27;,dictcookie)
import json
jsoncookie = json.dumps(dictcookie)
print(&#x27;jsoncookie:&#x27;,jsoncookie)
with open(&#x27;jsoncookie.json&#x27;,&#x27;w&#x27;) as f:
    f.write(jsoncookie)
driver.close()</code></pre>

        </section>
        <section class="section">
            <h2 class="section-title" id="Part2éŸ³ä¹æ’­æ”¾å™¨">Part 2 éŸ³ä¹æ’­æ”¾å™¨</h2>
        </section>
        <section class="section">
            <h2 class="section-title" id=""></h2>
            <div class="subsection">
                <h3 class="subsection-title", id="æ¶æ„è®¾è®¡">æ¶æ„è®¾è®¡</h3>
                <p>è¿™ä¸€éƒ¨åˆ†ç¨‹åºé‡‡ç”¨åŒçº¿ç¨‹æ¶æ„ï¼š</p>

                <div class="note">
                    <strong>ğŸ’¡</strong>
                    <ul>
                        <li>UIçº¿ç¨‹ï¼šè´Ÿè´£å¤„ç†ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼Œé€šè¿‡æŒ‰é’®æ“ä½œè®¾ç½®å…¨å±€çŠ¶æ€æ ‡å¿—</li>
                        <li>æ’­æ”¾çº¿ç¨‹ï¼šæ‰§è¡Œæ ¸å¿ƒæ’­æ”¾é€»è¾‘ï¼Œç›‘æ§å…¨å±€çŠ¶æ€æ ‡å¿—è¿›è¡Œå“åº”</li>
                    </ul>
                </div>

                <p>è¿™ç§è®¾è®¡é¿å…äº†<code>selenium</code>æ“ä½œé˜»å¡ä¸»çº¿ç¨‹ï¼Œç¡®ä¿ç•Œé¢å§‹ç»ˆå“åº”æµç•…ã€‚</p>
                <p>ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡<code>å…±äº«å…¨å±€å˜é‡</code>å®ç°é€šä¿¡ï¼Œä»¥ä¸‹æ˜¯å…³é”®çŠ¶æ€æ ‡å¿—è¯´æ˜ï¼š</p>
                <div class="markdown-table-container">
                    <table class="markdown-table">
                        <thead>
                            <tr>
                                <th style="text-align: left">å…¨å±€å˜é‡</th>
                                <th style="text-align: left">ä½œç”¨åŸŸ</th>
                                <th style="text-align: left">åŠŸèƒ½æè¿°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="text-align: left">is_loop</td>
                                <td style="text-align: left">æ’­æ”¾æ¨¡å¼æ§åˆ¶</td>
                                <td style="text-align: left">åˆ—è¡¨å¾ªç¯</td>
                            </tr>
                            <tr>
                                <td style="text-align: left">is_repeat</td>
                                <td style="text-align: left">æ’­æ”¾æ¨¡å¼æ§åˆ¶</td>
                                <td style="text-align: left">å•æ›²å¾ªç¯</td>
                            </tr>
                            <tr>
                                <td style="text-align: left">is_shuffle</td>
                                <td style="text-align: left">æ’­æ”¾æ¨¡å¼æ§åˆ¶</td>
                                <td style="text-align: left">éšæœºæ’­æ”¾</td>
                            </tr>
                            <tr>
                                <td style="text-align: left">is_next</td>
                                <td style="text-align: left">æ’­æ”¾æ§åˆ¶</td>
                                <td style="text-align: left">åˆ‡æ¢ä¸‹ä¸€æ›²</td>
                            </tr>
                            <tr>
                                <td style="text-align: left">is_prev</td>
                                <td style="text-align: left">æ’­æ”¾æ§åˆ¶</td>
                                <td style="text-align: left">åˆ‡æ¢ä¸Šä¸€æ›²</td>
                            </tr>
                            <tr>
                                <td style="text-align: left">stop_thread</td>
                                <td style="text-align: left">ç¨‹åºç”Ÿå‘½å‘¨æœŸæ§åˆ¶</td>
                                <td style="text-align: left">ç»ˆæ­¢ç¨‹åº</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <section class="section">
            <h2 class="section-title" id=""></h2>
            <div class="subsection">
                <h3 class="subsection-title", id="æ’­æ”¾ä¸»å¾ªç¯è¯¦è§£">æ’­æ”¾ä¸»å¾ªç¯è¯¦è§£</h3>
                <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºbç«™åˆå§‹è®¾ç½®é—®é¢˜ï¼Œæ¯æ¬¡ç™»å½•æ—¶é»˜è®¤<code>é™éŸ³å¼€æ’­</code>å¹¶ä¸”<code>è‡ªåŠ¨è¿æ’­</code>ï¼Œéœ€è¦å¯¹è¿™éƒ¨åˆ†è¿›è¡Œé¢å¤–å¤„ç†</p>

                <pre class="language-python"><code>def play_loop():
    global i  # å½“å‰æ’­æ”¾ç´¢å¼•
    while not stop_thread:
        # æ’­æ”¾ç´¢å¼•è¾¹ç•Œæ£€æµ‹
        if i &gt;= num:
            if is_loop: i = 0  # å¾ªç¯æ¨¡å¼é‡ç½®ç´¢å¼•
            else: break        # éå¾ªç¯æ¨¡å¼ç»“æŸæ’­æ”¾
        
        # åŠ è½½è§†é¢‘é¡µé¢
        driver.get(video_links[i])
        video = driver.find_element(By.CSS_SELECTOR, &quot;video&quot;)
        
        # é¦–è§†é¢‘åˆå§‹åŒ–æ“ä½œ
        if is_first_video:
            driver.execute_script(&quot;arguments[0].pause()&quot;, video)
            driver.execute_script(&quot;arguments[0].currentTime = 0;&quot;, video)
            # éŸ³é‡/è¿ç»­æ’­æ”¾è®¾ç½®ï¼ˆç•¥ï¼‰
        
        # è·å–è§†é¢‘å…ƒæ•°æ®
        video_duration = driver.execute_script(&quot;return arguments[0].duration;&quot;, video)
        
        # æ›´æ–°UIæ˜¾ç¤º
        song_name_label.config(text=f&quot;â™« {processed_song_name} &quot;)
        current_time_label.config(text=&quot;00:00&quot;)
        
        # å¯åŠ¨è§†é¢‘æ’­æ”¾
        driver.execute_script(&quot;arguments[0].play();&quot;, video)
        
        # å®æ—¶æ’­æ”¾ç›‘æ§
        while True:
            if stop_thread: return  # å¼ºåˆ¶ç»ˆæ­¢æ£€æµ‹
            if driver.execute_script(&quot;return arguments[0].ended;&quot;, video):
                break  # è‡ªç„¶æ’­æ”¾ç»“æŸ
            # æ›´æ–°æ—¶é—´æ˜¾ç¤ºï¼ˆç•¥ï¼‰
            
            # å¼ºåˆ¶åˆ‡æ­Œæ£€æµ‹
            if is_next or is_prev:
                break  # é€€å‡ºå½“å‰æ’­æ”¾å¾ªç¯
            time.sleep(1)
        
        # æ’­æ”¾æ¨¡å¼å¤„ç†
        if not is_repeat:
            i += 1  # éå•æ›²å¾ªç¯æ—¶é€’å¢ç´¢å¼•</code></pre>

            </div>
        </section>
        <section class="section">
            <h2 class="section-title" id=""></h2>
            <div class="subsection">
                <h3 class="subsection-title", id="æ’­æ”¾æ¨¡å¼åˆ‡æ¢æœºåˆ¶">æ’­æ”¾æ¨¡å¼åˆ‡æ¢æœºåˆ¶</h3>
                <p>é€šè¿‡<code>toggle_loop()</code>å‡½æ•°å®ç°å››ç§æ’­æ”¾æ¨¡å¼çš„è½®æ¢åˆ‡æ¢ï¼š</p>

                <pre class="language-python"><code>def toggle_loop():
    global play_mode
    play_mode = play_mode % play_mode_num + 1
    
    # æ¨¡å¼å¯¹åº”æ“ä½œ
    if play_mode == 1:   # åˆ—è¡¨å¾ªç¯
        is_loop = True
        loop_button.config(text=&quot;ğŸ”&quot;)
    elif play_mode == 2: # é¡ºåºæ’­æ”¾
        is_loop = False
        loop_button.config(text=&quot;â¡ï¸&quot;)
    elif play_mode == 3: # å•æ›²å¾ªç¯
        is_repeat = True
        loop_button.config(text=&quot;ğŸ”‚&quot;)
    elif play_mode == 4: # éšæœºæ’­æ”¾
        shuffle_video()  # æ‰§è¡Œæ´—ç‰Œç®—æ³•
        loop_button.config(text=&quot;ğŸ”€&quot;)</code></pre>

            </div>
        </section>
        <section class="section">
            <h2 class="section-title" id=""></h2>
            <div class="subsection">
                <h3 class="subsection-title", id="å…³é”®æŠ€æœ¯ç‚¹è§£æ">å…³é”®æŠ€æœ¯ç‚¹è§£æ</h3>
                <p>1. Seleniumç½‘é¡µæ§åˆ¶ï¼š</p>

                <div class="note">
                    <strong>ğŸ’¡</strong>
                    <ul>
                        <li>é€šè¿‡execute_script()æ‰§è¡ŒJavaScriptç›´æ¥æ“ä½œè§†é¢‘å…ƒç´ </li>
                        <li>ç¤ºä¾‹ï¼šdriver.execute_script(&quot;arguments[0].play();&quot;, video)å¯åŠ¨æ’­æ”¾</li>
                        <li>ç¤ºä¾‹ï¼šdriver.execute_script(&quot;return arguments[0].duration;&quot;, video)è·å–è§†é¢‘æ—¶é•¿</li>
                    </ul>
                </div>

                <p>2. éšæœºæ’­æ”¾å®ç°ï¼š</p>

                <pre class="language-python"><code>def shuffle_video():
    global video_links, temp_list
    temp_list = video_links.copy()  # å¤‡ä»½åŸå§‹åˆ—è¡¨
    random.shuffle(video_links)     # ç”Ÿæˆéšæœºåºåˆ—</code></pre>

                <p>ä½¿ç”¨ä¸´æ—¶åˆ—è¡¨ä¿å­˜åŸå§‹é¡ºåºï¼Œæ¢å¤æ—¶ç›´æ¥<code>video_links = temp_list.copy()</code></p>
                <p>3. è·¨çº¿ç¨‹é€šä¿¡ï¼š</p>

                <div class="note">
                    <strong>ğŸ’¡</strong>
                    <ul>
                        <li>UIçº¿ç¨‹é€šè¿‡ä¿®æ”¹is_next/is_prevæ ‡å¿—é€šçŸ¥æ’­æ”¾çº¿ç¨‹</li>
                        <li>æ’­æ”¾çº¿ç¨‹æ¯æ¬¡å¾ªç¯å¼€å§‹éƒ½ä¼šæ£€æŸ¥è¿™äº›æ ‡å¿—ä½</li>
                    </ul>
                </div>

            </div>
        </section>
        <section class="section">
            <h2 class="section-title" id="æ€»ç»“">æ€»ç»“</h2>
            <p>è¿™ä¸ªç¨‹åºæœ€å¼€å§‹åªæœ‰å‘½ä»¤è¡Œç•Œé¢ï¼Œç»è¿‡å‡ æ¬¡å‡çº§ï¼Œæœ€ç»ˆå®ç°äº†GUIç•Œé¢æ“ä½œã€‚</p>
            <p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>

            <pre class="language-python"><code># AutoPlayerGUI.py
from selenium import webdriver
from selenium.webdriver.common.by import By
import tkinter as tk
from tkinter import font
import ctypes
import random
import time
import json
import re
import threading

with open(&#x27;playlist.json&#x27;, &#x27;r&#x27;) as f:
    video_links = json.load(f)
temp_list = []

driver = webdriver.Edge()
driver.get(&#x27;https://www.bilibili.com/&#x27;)
driver.delete_all_cookies()
with open(&#x27;jsoncookie.json&#x27;, &#x27;r&#x27;) as f:
    ListCookies = json.loads(f.read())
for cookie in ListCookies:
    driver.add_cookie({
        &#x27;domain&#x27;: &#x27;.bilibili.com&#x27;,
        &#x27;name&#x27;: cookie[&#x27;name&#x27;],
        &#x27;value&#x27;: cookie[&#x27;value&#x27;],
        &#x27;path&#x27;: &#x27;/&#x27;,
        &#x27;expires&#x27;: None,
        &#x27;httponly&#x27;: False,
    })
driver.get(&#x27;https://www.bilibili.com/&#x27;)

win = tk.Tk()
win.title(&quot;AutoPlayer&quot;)
win.attributes(&quot;-topmost&quot;, True)

#å‘Šè¯‰æ“ä½œç³»ç»Ÿä½¿ç”¨ç¨‹åºè‡ªèº«çš„dpié€‚é…
ctypes.windll.shcore.SetProcessDpiAwareness(1)
#è·å–å±å¹•çš„ç¼©æ”¾å› å­
ScaleFactor=ctypes.windll.shcore.GetScaleFactorForDevice(0)
#è®¾ç½®ç¨‹åºç¼©æ”¾
win.tk.call(&#x27;tk&#x27;, &#x27;scaling&#x27;, ScaleFactor/75)

# å…¨å±€å˜é‡
stop_thread = False  # æ ‡å¿—ä½ï¼Œç”¨äºç»“æŸçº¿ç¨‹
is_first_video = True
is_loop = True
is_repeat = False
is_shuffle = False
is_pause = False
is_next = False
is_prev = False
play_mode = 1
play_mode_num = 4 # 4ç§æ’­æ”¾æ¨¡å¼
i = 0
video_duration = 0
video = 0
num = len(video_links)

def play_loop():
    global i
    global is_first_video
    global is_pause
    global video_duration
    global video
    global is_prev
    global is_next
    
    while not stop_thread:  # æ£€æŸ¥æ˜¯å¦éœ€è¦ç»“æŸ
        if i &gt;= num:
            if is_loop:
                i = 0
            else:
                break

        driver.get(video_links[i])
        time.sleep(2)
        video = driver.find_element(By.CSS_SELECTOR, &quot;video&quot;)
        if is_first_video:
            driver.execute_script(&quot;arguments[0].pause()&quot;, video)
            driver.execute_script(&quot;arguments[0].currentTime = 0;&quot;, video)
            volume_button = driver.find_element(By.CLASS_NAME, &quot;bpx-player-ctrl-btn.bpx-player-ctrl-volume&quot;)
            volume_button.click()
            switch_button = driver.find_element(By.CLASS_NAME, &quot;continuous-btn&quot;)
            switch_button.click()
            is_first_video = False
        video_duration = driver.execute_script(&quot;return arguments[0].duration;&quot;, video)
        minutes = int(video_duration // 60)
        seconds = int(video_duration % 60)
        temp_song_name = driver.find_element(By.CLASS_NAME, &quot;tag-txt&quot;)
        pattern = re.compile(re.escape(&quot;å‘ç°ã€Š&quot;))
        song_name = pattern.sub(&#x27;&#x27;, temp_song_name.text)
        pattern = re.compile(r&#x27;ã€‹&#x27;)
        song_name = pattern.sub(&#x27;&#x27;, song_name)
        song_name = re.sub(r&#x27;[â€˜â€™]&#x27;, &quot;&#x27;&quot;, song_name)
        song_name = re.sub(r&#x27;[â€œâ€]&#x27;, &#x27;&quot;&#x27;, song_name)
        driver.execute_script(&quot;arguments[0].play();&quot;, video)
        if song_name is not None:
            song_name_label.config(text=f&quot;â™« {song_name} &quot;)
            current_time_label.config(text=&quot;00:00&quot;)
            duration_label.config(text=f&quot;/ {minutes:02d}:{seconds:02d}&quot;)
        while True:
            if stop_thread:
                return
            if driver.execute_script(&quot;return arguments[0].ended;&quot;, video):
                break
            current_time = driver.execute_script(&quot;return arguments[0].currentTime;&quot;, video)
            minutes = int(current_time // 60)
            seconds = int(current_time % 60)
            current_time_label.config(text=f&quot;{minutes:02d}:{seconds:02d}&quot;)
            if stop_thread:
                break  # å¦‚æœçº¿ç¨‹éœ€è¦ç»“æŸï¼Œåˆ™é€€å‡º
            if is_next:
                is_next = False
                break
            if is_prev:
                is_prev = False
                break
            time.sleep(1)
        if not is_repeat:
            i += 1

def play_video():
    global video
    driver.execute_script(&quot;arguments[0].play();&quot;, video)

def pause_video():
    global video
    driver.execute_script(&quot;arguments[0].pause();&quot;, video)

def play_or_pause():
    global is_pause  # å£°æ˜is_pauseä¸ºå…¨å±€å˜é‡
    if is_pause:
        is_pause = False
        play_button.config(text=&quot;â¸ï¸&quot;)  # æ›´æ–°æ—¶é—´ä¸ºæš‚åœå›¾æ ‡
        play_video()
    else:
        is_pause = True
        play_button.config(text=&quot;â–¶&quot;)  # æ›´æ–°æ—¶é—´ä¸ºæ’­æ”¾å›¾æ ‡
        pause_video()

def next_video():
    global video_duration
    global video
    global is_next 
    is_next = True
    #driver.execute_script(f&quot;arguments[0].currentTime = {video_duration};&quot;, video)

def prev_video():
    global i
    global video
    global video_duration
    global is_prev
    i -= 2
    if i &lt; 0 and is_loop:
        i = num - 2
    is_prev = True
    #driver.execute_script(f&quot;arguments[0].currentTime = {video_duration};&quot;, video)

def fast_forward_video():
    global video
    global video_duration
    driver.execute_script(f&quot;if (arguments[0].currentTime + 5 &gt;= {video_duration}) arguments[0].currentTime = {video_duration}; else arguments[0].currentTime += 5;&quot;, video)

def fast_reverse_video():
    global video
    global video_duration
    driver.execute_script(&quot;if (arguments[0].currentTime - 5 &lt;= 0) arguments[0].currentTime = 0; else arguments[0].currentTime -= 5;&quot;, video)

def shuffle_video():
    global video_links
    global temp_list
    temp_list = list(video_links)
    random.shuffle(video_links)

def revert_video():
    global is_shuffle
    global video_links
    global temp_list
    if is_shuffle:
        video_links = list(temp_list)
        is_shuffle = False

def toggle_loop():
    global play_mode
    global is_loop
    global is_repeat
    global is_shuffle
    
    play_mode += 1
    if play_mode &gt; play_mode_num:
        play_mode = 1
    
    if play_mode == 1:  # 1-åˆ—è¡¨å¾ªç¯
        is_loop = True
        is_repeat = False
        loop_button.config(text=&quot;ğŸ”&quot;)
        revert_video()
    elif play_mode == 2:  # 2-é¡ºåºæ’­æ”¾
        is_loop = False
        is_repeat = False
        loop_button.config(text=&quot;â¡ï¸&quot;)
        revert_video()
    elif play_mode == 3:  # 3-å•æ›²å¾ªç¯
        is_loop = False
        is_repeat = True
        loop_button.config(text=&quot;ğŸ”‚&quot;)
    if play_mode == 4:  # 4-éšæœºæ’­æ”¾
        is_loop = True
        is_repeat = False
        is_shuffle = True
        loop_button.config(text=&quot;ğŸ”€&quot;)
        shuffle_video()

def on_closing():
    global stop_thread
    stop_thread = True  # è®¾ç½®æ ‡å¿—ä½ä¸ºTrueï¼Œé€šçŸ¥çº¿ç¨‹ç»“æŸ
    win.destroy()  # é”€æ¯çª—å£
    driver.quit()  # ç¡®ä¿ WebDriver æ­£ç¡®å…³é—­
    # ç­‰å¾…çº¿ç¨‹ç»“æŸ
    for thread in threading.enumerate():
        if thread != threading.current_thread():
            thread.join()


head_font = font.Font(font=(&quot;å¾®è½¯é›…é»‘&quot;, 12))
time_font = font.Font(font=(&quot;å¾®è½¯é›…é»‘&quot;, 8))
button_font = font.Font(font=(&quot;å¾®è½¯é›…é»‘&quot;, 14))

head_frame = tk.Frame(win)
song_name_label = tk.Label(head_frame, text=&quot;â™«&quot;, font=head_font)
current_time_label = tk.Label(head_frame, font=time_font)
duration_label = tk.Label(head_frame, font=time_font)

# åˆ›å»ºæŒ‰é’®
button_frame = tk.Frame(win)
prev_button = tk.Button(button_frame, text=&quot;â®ï¸&quot;, command=prev_video, font=button_font)
fast_reverse_button = tk.Button(button_frame, text=&quot;âª&quot;, command=fast_reverse_video, font=button_font)
play_button = tk.Button(button_frame, text=&quot;â¸ï¸&quot;, command=play_or_pause, font=button_font)
fast_forward_button = tk.Button(button_frame, text=&quot;â©&quot;, command=fast_forward_video, font=button_font)
next_button = tk.Button(button_frame, text=&quot;â­ï¸&quot;, command=next_video, font=button_font)
loop_button = tk.Button(button_frame, text=&quot;ğŸ”&quot;, command=toggle_loop, font=button_font)

# å¸ƒå±€æŒ‰é’®ä¸ºæ°´å¹³
song_name_label.pack(side=&quot;left&quot;)
current_time_label.pack(side=&quot;left&quot;)
duration_label.pack(side=&quot;left&quot;)
head_frame.pack()
prev_button.pack(side=tk.LEFT)
fast_reverse_button.pack(side=tk.LEFT)
play_button.pack(side=tk.LEFT)
fast_forward_button.pack(side=tk.LEFT)
next_button.pack(side=tk.LEFT)
loop_button.pack(side=tk.LEFT)
button_frame.pack()

# ç»‘å®šå…³é—­äº‹ä»¶
win.protocol(&quot;WM_DELETE_WINDOW&quot;, on_closing)

# å¯åŠ¨æ’­æ”¾å¾ªç¯çº¿ç¨‹
threading.Thread(target=play_loop).start()

win.mainloop()

if not stop_thread:
    driver.quit()</code></pre>

        </section>

        <!-- ç´¢å¼•éƒ¨åˆ† -->
        <div class="guide-grid">
            <article class="guide-card">
                <div class="guide-card-left">
                    <span class="guide-date">Last post</span>
                    <a href="https://coccusq.github.io/build-tools" class="guide-title-link">
                        <h2 class="guide-title">Â« æ¨¡æ¿åŒ–ç½‘é¡µç”Ÿæˆå·¥å…·ï¼šMarkdownConverter&amp;BlogGeneratorâ€”â€”åŸç†ã€åŠŸèƒ½ä¸ä½¿ç”¨æ–¹æ³•è¯¦è§£</h2>
                    </a>
                </div>
            </article>
            <article class="guide-card">
                <div class="guide-card-right">
                    <span class="guide-date">Next post</span>
                    <a href="#" class="guide-title-link">
                        <h2 class="guide-title"> Â»</h2>
                    </a>
                </div>
            </article>
        </div>
    </main>

    <!-- å³ä¾§è¾¹æ  -->
    <aside class="sidebar-right">
        <div class="sidebar-header">æ–‡æ¡£ç›®å½•</div>
        <nav class="sidebar-nav" id="sidebar-nav"></nav>
    </aside>

    <!-- é¡µè„šå†…å®¹ -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h4 class="footer-title">About us</h4>
                <div class="footer-links">
                    <a href="https://coccusq.github.io/about">âœ’ï¸Learn More</a>
                    <a href="https://coccusq.github.io/build-tools">ğŸ› ï¸Build-tools</a>
                </div>
            </div>
            <div class="footer-column">
                <h4 class="footer-title">Useful Tools</h4>
                <div class="footer-links">
                    <a href="https://chat.deepseek.com">ğŸ¤–DeepSeek</a>
                    <a href="https://github.com/cayxc/Mdtht">ğŸ“‘Mdtht</a>
                    <a href="https://www.emojiall.com">ğŸ˜„EMOJIALL</a>
                </div>
            </div>
            <div class="footer-column">
                <h4 class="footer-title">Social</h4>
                <div class="footer-links">
                    <a href="mailto:king_crab_cn@outlook.com">Email</a>
                    <a href="https://github.com/CoccusQ/coccusq.github.io">GitHubâ†—</a>
                </div>
            </div>
        </div>
        <div class="footer-divider"></div>
        <div class="footer-copyright">
            <p>Â© 2025 CoccusQ ğŸ‡¨ğŸ‡³. All rights reserved.</p>
        </div>
    </footer>

    <div class="copy-feedback" id="copyFeedback"></div>

    <script src="script.js"></script>

    <!-- ä»£ç é«˜äº® -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-c.min.js"></script>
</body>

</html>